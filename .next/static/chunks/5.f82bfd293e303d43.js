"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5],{7236:(e,t,i)=>{i.d(t,{N:()=>n,U:()=>a});var r=i(19338);function a(){return(0,r.createBrowserClient)("https://nzeqnvmepoykadilajud.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im56ZXFudm1lcG95a2FkaWxhanVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5OTMzMDAsImV4cCI6MjA4NDU2OTMwMH0.igLBLX9XCMVkAthRm4T4pHiNU4iF9c5RoI2JGYHsPrI")}let n=a()},15664:(e,t,i)=>{i.d(t,{$:()=>n.useGamification,GamificationProvider:()=>l});var r=i(95155),a=i(37206),n=i(75004);let s=(0,a.default)(()=>Promise.resolve().then(i.bind(i,75004)).then(e=>e.GamificationProviderClient),{loadableGenerated:{webpack:()=>[75004]},ssr:!1});function l({children:e}){return(0,r.jsx)(s,{children:e})}},24683:(e,t,i)=>{i.d(t,{k:()=>s});var r=i(95155);i(12115);var a=i(29885),n=i(91337);function s({className:e,value:t,...i}){return(0,r.jsx)(a.bL,{"data-slot":"progress",className:(0,n.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",e),...i,children:(0,r.jsx)(a.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})})}},29885:(e,t,i)=>{i.d(t,{C1:()=>_,bL:()=>x});var r=i(12115),a=i(68599),n=i(55897),s=i(95155),l="Progress",[o,c]=(0,a.A)(l),[d,u]=o(l),m=r.forwardRef((e,t)=>{var i,r;let{__scopeProgress:a,value:l=null,max:o,getValueLabel:c=g,...u}=e;(o||0===o)&&!k(o)&&console.error((i=`${o}`,`Invalid prop \`max\` of value \`${i}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let m=k(o)?o:100;null===l||v(l,m)||console.error((r=`${l}`,`Invalid prop \`value\` of value \`${r}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let f=v(l,m)?l:null,p=y(f)?c(f,m):void 0;return(0,s.jsx)(d,{scope:a,value:f,max:m,children:(0,s.jsx)(n.sG.div,{"aria-valuemax":m,"aria-valuemin":0,"aria-valuenow":y(f)?f:void 0,"aria-valuetext":p,role:"progressbar","data-state":h(f,m),"data-value":f??void 0,"data-max":m,...u,ref:t})})});m.displayName=l;var f="ProgressIndicator",p=r.forwardRef((e,t)=>{let{__scopeProgress:i,...r}=e,a=u(f,i);return(0,s.jsx)(n.sG.div,{"data-state":h(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:t})});function g(e,t){return`${Math.round(e/t*100)}%`}function h(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function y(e){return"number"==typeof e}function k(e){return y(e)&&!isNaN(e)&&e>0}function v(e,t){return y(e)&&!isNaN(e)&&e<=t&&e>=0}p.displayName=f;var x=m,_=p},75004:(e,t,i)=>{i.r(t),i.d(t,{GamificationProviderClient:()=>l,useGamification:()=>o});var r=i(95155),a=i(12115),n=i(7236);let s=(0,a.createContext)(void 0);function l({children:e}){let[t,i]=(0,a.useState)(null),[l,o]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{async function e(){let{data:{user:e}}=await n.N.auth.getUser();if(!e)return void o(!1);let{data:t,error:r}=await n.N.from("user_gamification").select("*").eq("user_id",e.id).single();t?i(t):r&&"PGRST116"!==r.code&&console.error("Error fetching gamification data:",r),o(!1)}e();let{data:t}=n.N.auth.onAuthStateChange((t,r)=>{"SIGNED_IN"===t?e():"SIGNED_OUT"===t&&i(null)});return()=>{t.subscription.unsubscribe()}},[]),(0,r.jsx)(s.Provider,{value:{gamification:t,loading:l},children:e})}function o(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useGamification must be used within a GamificationProvider");return e}},76537:(e,t,i)=>{i.d(t,{$S:()=>y,Zf:()=>h,eI:()=>v,kt:()=>p,recordLike:()=>m,recordPlay:()=>u,recordPlaylistCreate:()=>f,sH:()=>k,uL:()=>g});var r=i(98349),a=i.n(r);let n="user_gamification_data",s=[0,100,250,500,800,1200,1700,2300,3e3,4e3,5200,6500,8e3,1e4,12500,15500,19e3,23e3,28e3,35e3],l=[{id:"first-play",title:"First Note",description:"Play your first track",icon:"play",category:"listening",requirement:1},{id:"tracks-10",title:"Getting Started",description:"Play 10 tracks",icon:"music",category:"listening",requirement:10},{id:"tracks-50",title:"Music Lover",description:"Play 50 tracks",icon:"headphones",category:"listening",requirement:50},{id:"tracks-100",title:"Audiophile",description:"Play 100 tracks",icon:"disc",category:"listening",requirement:100},{id:"minutes-60",title:"Hour Power",description:"Listen for 60 minutes",icon:"clock",category:"listening",requirement:60},{id:"minutes-600",title:"Marathon Listener",description:"Listen for 10 hours",icon:"timer",category:"listening",requirement:600},{id:"streak-3",title:"Hat Trick",description:"3-day listening streak",icon:"flame",category:"streak",requirement:3},{id:"streak-7",title:"Weekly Warrior",description:"7-day listening streak",icon:"fire",category:"streak",requirement:7},{id:"streak-30",title:"Monthly Master",description:"30-day listening streak",icon:"trophy",category:"streak",requirement:30},{id:"likes-5",title:"Picky Listener",description:"Like 5 tracks",icon:"heart",category:"collection",requirement:5},{id:"likes-25",title:"Curator",description:"Like 25 tracks",icon:"heart-filled",category:"collection",requirement:25},{id:"likes-100",title:"Tastemaker",description:"Like 100 tracks",icon:"star",category:"collection",requirement:100},{id:"playlist-1",title:"DJ Beginner",description:"Create your first playlist",icon:"list-music",category:"collection",requirement:1},{id:"playlist-5",title:"Playlist Pro",description:"Create 5 playlists",icon:"list-plus",category:"collection",requirement:5},{id:"download-1",title:"Offline Explorer",description:"Download your first track",icon:"download",category:"collection",requirement:1},{id:"download-10",title:"On-the-Go",description:"Download 10 tracks",icon:"download-cloud",category:"collection",requirement:10},{id:"share-1",title:"Spreading the Word",description:"Share your first track",icon:"share",category:"social",requirement:1},{id:"share-10",title:"Socialite",description:"Share 10 tracks",icon:"share-2",category:"social",requirement:10}];async function o(){return await a().getItem(n)||{xp:0,level:1,streak:0,longest_streak:0,last_listened_date:null,total_tracks_played:0,total_listening_minutes:0,total_likes:0,total_playlists:0,total_downloads:0,total_shares:0,unlocked_achievements:new Set}}async function c(e){await a().setItem(n,e)}async function d(e,t){let i=await o(),r=i.level;t(i);let a=i.xp+e;i.xp=a;let n=function(e){for(let t=s.length-1;t>=0;t--)if(e>=s[t])return t+1;return 1}(a),d=n>r;i.level=n;let u=function(e){let t=[];for(let i of l){if(e.unlocked_achievements.has(i.id))continue;let r=0;switch(i.category){case"listening":r=i.id.includes("tracks")?e.total_tracks_played:i.id.includes("minutes")?e.total_listening_minutes:e.total_tracks_played;break;case"streak":r=e.streak;break;case"collection":i.id.includes("like")?r=e.total_likes:i.id.includes("playlist")?r=e.total_playlists:i.id.includes("download")&&(r=e.total_downloads);break;case"social":r=e.total_shares}r>=i.requirement&&(t.push(i),e.unlocked_achievements.add(i.id))}return t}(i);return await c(i),{newAchievements:u,leveledUp:d,newXp:a,userState:i}}function u(e=0){return d(10,t=>{t.total_tracks_played+=1,t.total_listening_minutes+=Math.round(e/60);let i=new Date().toDateString();if(t.last_listened_date!==i){let e=new Date(Date.now()-864e5).toDateString();t.last_listened_date===e?t.streak+=1:t.streak=1,t.last_listened_date=i,t.streak>t.longest_streak&&(t.longest_streak=t.streak)}})}function m(){return d(5,e=>{e.total_likes+=1})}function f(){return d(25,e=>{e.total_playlists+=1})}function p(){return d(15,e=>{e.total_downloads+=1})}let g=o;function h(e){for(let t=s.length-1;t>=0;t--)if(e>=s[t])return t+1;return 1}function y(e){return e>=s.length?2*s[s.length-1]:s[e]??s[0]}function k(e,t){let i=s[t-1]||0,r=y(t);return r===i?0:Math.min(Math.max((e-i)/(r-i)*100,0),100)}function v(e){let t=["Newbie","Listener","Fan","Enthusiast","Devotee","Connoisseur","Expert","Master","Legend","Virtuoso","Maestro","Prodigy","Savant","Luminary","Icon","Phenom","Oracle","Titan","Deity","Transcendent"];return t[Math.min(e-1,t.length-1)]||"Transcendent"}},80005:(e,t,i)=>{i.r(t),i.d(t,{GamificationWidgetClient:()=>o});var r=i(95155),a=i(15664),n=i(76537),s=i(24683),l=i(94928);function o(){let{gamification:e,loading:t}=(0,a.$)();if(t||!e)return(0,r.jsxs)("div",{className:"p-4 bg-card rounded-lg flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-secondary animate-pulse"}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-secondary rounded w-3/4 animate-pulse"}),(0,r.jsx)("div",{className:"h-3 bg-secondary rounded w-1/2 animate-pulse"})]})]});let{xp:i,level:o}=e,c=(0,n.sH)(i,o),d=(0,n.Zf)(i),u=(0,n.eI)(d);return(0,r.jsxs)("div",{className:"p-4 bg-card rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(l.A,{className:"w-10 h-10 text-yellow-500"}),(0,r.jsx)("span",{className:"absolute -top-1 -right-1 bg-primary text-primary-foreground text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:d})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-semibold text-foreground text-sm",children:u}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Level ",d]})]})]}),(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)(s.k,{value:c,className:"h-2"}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground mt-1 text-right",children:[" ",i," XP "]})]})]})}}}]);